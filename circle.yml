# Customize the test machine
machine:
  node:
    version: 7.10.0
  ruby:
    version: 2.1.2

  # Override /etc/hosts
  services:
    - docker

dependencies:
  pre:
    - chmod +x -R scripts/*
    - git clone https://github.com/swagger-api/swagger-codegen
    - cd swagger-codegen && ./run-in-docker.sh mvn package
    - sh scripts/generate-v1-sdks-circleci.sh
    - cd quantimodo_v1_skds/javascript && npm install && npm test
    - curl -u HtT2C7gL6ALepi8g: "https://assertible.com/deployments" -d'{"service": "28000e7f-867d-4f02-854f-ceb9519fbe32", "environmentName": "production", "version": "v1"}'

general:
  artifacts:
    - "swagger-codegen/quantimodo_v1_skds.zip"
    - "swagger-codegen/api-docs.json"

deployment:
  prod:
    branch: master
    commands:
      - aws s3 cp ~/docs/swagger-codegen/quantimodo_v1_skds.zip s3://quantimodo-docs/